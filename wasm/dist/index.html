<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>WMF to SVG</title>
  </head>
  <body>
    <h1>WMF to SVG</h1>

    <h2>WMF File:</h2>
    <input id="input" type="file" accept=".wmf" />

    <h2>SVG Output:</h2>
    <div id="output" style="border: solid black; padding: 10px;"></div>

    <script type="module">
      import init, { convertWmf2Svg, setLogLevel } from './wmf_wasm.js';

      async function run() {
        await init();
        setLogLevel("debug");

        document.getElementById('input').addEventListener('change', () => {
          const input = document.getElementById("input");
          const files = input.files;

          if (files === null || files.length === 0) {
              return;
          }

          const fileReader = new FileReader();

          fileReader.onload = function (e) {
            const bytes = new Uint8Array(new Uint8Array(e.target.result));
            const output = convertWmf2Svg(bytes);

            document.getElementById("output").innerHTML = output;
          };

          fileReader.readAsArrayBuffer(files[0]);
        });
      }

      run();
    </script>
  </body>
</html>
